---
layout: post
title:  "Day 8: Handling Missing and Outlier Data"
date: 2025-03-06
categories: study-logs
tag: [python, blog, data-cleaning, outliers,missing-data]
toc: true
author_profile: false
excerpt: "Handling missing values and outliers in datasets using Python."
---

<head>
  <style>
    table.dataframe {
      white-space: normal;
      width: 100%;
      height: 240px;
      display: block;
      overflow: auto;
      font-family: Arial, sans-serif;
      font-size: 0.9rem;
      line-height: 20px;
      text-align: center;
      border: 0px !important;
    }

    table.dataframe th {
      text-align: center;
      font-weight: bold;
      padding: 8px;
    }

    table.dataframe td {
      text-align: center;
      padding: 8px;
    }

    table.dataframe tr:hover {
      background: #b8d1f3; 
    }

    .output_prompt {
      overflow: auto;
      font-size: 0.9rem;
      line-height: 1.45;
      border-radius: 0.3rem;
      -webkit-overflow-scrolling: touch;
      padding: 0.8rem;
      margin-top: 0;
      margin-bottom: 15px;
      font: 1rem Consolas, "Liberation Mono", Menlo, Courier, monospace;
      color: $code-text-color;
      border: solid 1px $border-color;
      border-radius: 0.3rem;
      word-break: normal;
      white-space: pre;
    }

  .dataframe tbody tr th:only-of-type {
      vertical-align: middle;
  }

  .dataframe tbody tr th {
      vertical-align: top;
  }

  .dataframe thead th {
      text-align: center !important;
      padding: 8px;
  }

  .page__content p {
      margin: 0 0 0px !important;
  }

  .page__content p > strong {
    font-size: 0.8rem !important;
  }

  </style>
</head>


 # 자료 준비 및 손질



```python
import pandas as pd
import numpy as np
fruits = pd.Series(['바나나','아보카도',np.nan,'키위'])
fruits
```

<pre>
0     바나나
1    아보카도
2     NaN
3      키위
dtype: object
</pre>

```python
fruits.isnull()
```

<pre>
0    False
1    False
2     True
3    False
dtype: bool
</pre>

```python
fruits[0] = None
fruits
```

<pre>
0    None
1    아보카도
2     NaN
3      키위
dtype: object
</pre>

```python
fruits.notnull()
```

<pre>
0    False
1     True
2    False
3     True
dtype: bool
</pre>

```python
fruits[fruits.notnull()]
```

<pre>
1    아보카도
3      키위
dtype: object
</pre>

```python
fruits=fruits.dropna()
```


```python
fruits
```

<pre>
1    아보카도
3      키위
dtype: object
</pre>

```python
frame = pd.DataFrame([[1., 3.5, 2.2], [1, np.nan, np.nan], [np.nan, np.nan, np.nan], [np.nan, 4.5, 6.4]])
```


```python
frame.dropna() # 결측치가 있는 행 삭제
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>3.5</td>
      <td>2.2</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.dropna(how = "all") # 모든 값이 naN인 행/열 삭제
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>3.5</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>4.5</td>
      <td>6.4</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.dropna(axis=1) # 결측치가 있는 열 삭제
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
    </tr>
    <tr>
      <th>1</th>
    </tr>
    <tr>
      <th>2</th>
    </tr>
    <tr>
      <th>3</th>
    </tr>
  </tbody>
</table>
</div>



```python
frame.dropna(thresh=2) #NaN 이 아닌 값이 thresh 개 이상인 경우 유지
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>3.5</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>4.5</td>
      <td>6.4</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.dropna(subset=[2]) # 특정 열에서 결측치가 있는 NaN 삭제
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>3.5</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>4.5</td>
      <td>6.4</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame[3] =np.nan
frame
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>3.5</td>
      <td>2.2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>4.5</td>
      <td>6.4</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.dropna(axis=1, how = "all") 
# 결측치가 모두 nan 인 열 삭제 
# axis는 0,1만 가능
# 3열을 삭제하겠다고 절대 axis=3하면 안됌! 
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>3.5</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>4.5</td>
      <td>6.4</td>
    </tr>
  </tbody>
</table>
</div>



```python
#frame.fillna(0) #결측치가 nan 인값을 0으로 처리
```


```python
frame.fillna({1:0,2:1,3:2.4},inplace = True)
```


```python
frame
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>3.5</td>
      <td>2.2</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>4.5</td>
      <td>6.4</td>
      <td>2.4</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame =  pd.DataFrame(np.random.randn(6,3))
frame.iloc[2:, 1] =np.nan #2부터쭉
frame.iloc[4:, 2] =np.nan
frame
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.659542</td>
      <td>-0.056646</td>
      <td>0.417518</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.429638</td>
      <td>1.177371</td>
      <td>0.122469</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.094724</td>
      <td>NaN</td>
      <td>-0.974355</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.880604</td>
      <td>NaN</td>
      <td>0.049780</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.032375</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.707282</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.fillna(method='ffill')
```

<pre>
/var/folders/2v/xs6232zx39d2lk8wg9_m8w1m0000gn/T/ipykernel_72854/4287299861.py:1: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  frame.fillna(method='ffill')
</pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.659542</td>
      <td>-0.056646</td>
      <td>0.417518</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.429638</td>
      <td>1.177371</td>
      <td>0.122469</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.094724</td>
      <td>1.177371</td>
      <td>-0.974355</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.880604</td>
      <td>1.177371</td>
      <td>0.049780</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.032375</td>
      <td>1.177371</td>
      <td>0.049780</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.707282</td>
      <td>1.177371</td>
      <td>0.049780</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.fillna(method='ffill', limit =2)
```

<pre>
/var/folders/2v/xs6232zx39d2lk8wg9_m8w1m0000gn/T/ipykernel_72854/2716858046.py:1: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  frame.fillna(method='ffill', limit =2)
</pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.659542</td>
      <td>-0.056646</td>
      <td>0.417518</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.429638</td>
      <td>1.177371</td>
      <td>0.122469</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.094724</td>
      <td>1.177371</td>
      <td>-0.974355</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.880604</td>
      <td>1.177371</td>
      <td>0.049780</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.032375</td>
      <td>NaN</td>
      <td>0.049780</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.707282</td>
      <td>NaN</td>
      <td>0.049780</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.fillna(frame.mean()) #평균값으로 채워주기
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.659542</td>
      <td>-0.056646</td>
      <td>0.417518</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.429638</td>
      <td>1.177371</td>
      <td>0.122469</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.094724</td>
      <td>0.560363</td>
      <td>-0.974355</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.880604</td>
      <td>0.560363</td>
      <td>0.049780</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.032375</td>
      <td>0.560363</td>
      <td>-0.096147</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.707282</td>
      <td>0.560363</td>
      <td>-0.096147</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.fillna(frame.median()) #중간값으로 채워주기
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.659542</td>
      <td>-0.056646</td>
      <td>0.417518</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.429638</td>
      <td>1.177371</td>
      <td>0.122469</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.094724</td>
      <td>0.560363</td>
      <td>-0.974355</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.880604</td>
      <td>0.560363</td>
      <td>0.049780</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.032375</td>
      <td>0.560363</td>
      <td>0.086125</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.707282</td>
      <td>0.560363</td>
      <td>0.086125</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame = pd.DataFrame({"k1":['one','two']*3 + ['two'], "k2":[1,1,2,3,3,4,4]})
frame
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>two</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>one</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>two</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.duplicated() # 전체 값에 대한 중복 검사
```

<pre>
0    False
1    False
2    False
3    False
4    False
5    False
6     True
dtype: bool
</pre>

```python
frame.drop_duplicates() # 중복 값 제거
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>two</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>one</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>two</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame['k3']= range(7)
frame
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
      <th>k3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>two</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>one</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>two</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>4</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.drop_duplicates(['k1']) #특정 열 삭제
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
      <th>k3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>two</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.drop_duplicates(['k1','k2']) #열 중복
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
      <th>k3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>two</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>one</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>two</td>
      <td>4</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.drop_duplicates(['k1'], keep = 'last')
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k1</th>
      <th>k2</th>
      <th>k3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>one</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>4</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



```python
s = pd.Series([1.,-999, 2, -1000, 3])
s
```

<pre>
0       1.0
1    -999.0
2       2.0
3   -1000.0
4       3.0
dtype: float64
</pre>

```python
s.replace(-999,np.nan) #-999를 찾아서 nan 으로 교체
```

<pre>
0       1.0
1       NaN
2       2.0
3   -1000.0
4       3.0
dtype: float64
</pre>

```python
s.replace([-999,-1000],np.nan) #-999랑 -1000 둘다 nan 값으로 교체
```

<pre>
0    1.0
1    NaN
2    2.0
3    NaN
4    3.0
dtype: float64
</pre>

```python
s.replace([-999,-1000],[-9,-10]) #-999,-1000을 각각 -9,-10으로 교체
```

<pre>
0     1.0
1    -9.0
2     2.0
3   -10.0
4     3.0
dtype: float64
</pre>

```python
s.replace({-999:np.nan, -1000:0}) #-999는 nan으로 -1000은 0으로 교체
```

<pre>
0    1.0
1    NaN
2    2.0
3    0.0
4    3.0
dtype: float64
</pre>

```python
frame = pd.DataFrame(np.arange(12).reshape(3,4), index = ['Ohio', 'Colorado','New York'],
                    columns = ['ones', 'two', 'three', 'four'])
frame
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ones</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>



```python
lam =lambda x:x[:4].upper() #앞에 4글자 대문자로 바꾸기
frame.index.map(lam)
```

<pre>
Index(['OHIO', 'COLO', 'NEW '], dtype='object')
</pre>

```python
#map: Series, Index
#apply : Series, DataFrame
```


```python
frame.rename(index =str.title, columns=str.upper)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ONES</th>
      <th>TWO</th>
      <th>THREE</th>
      <th>FOUR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>



```python
frame.rename(index={'OHIO':'CALI'},columns={'three':'five'}) 
#OHIO를 CALI로 바꿈
#three 를 five로 바꿈
frame
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ones</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>



```python
age = [20,25,30,35,50,41,30,59,34,59,80,99,73,66]
dis = [18,29,45,60,100] #<- 이 구간으로 나누겠다

ge = pd.cut(age,dis) # age를 dis 로 구별해줘
ge
```

<pre>
[(18, 29], (18, 29], (29, 45], (29, 45], (45, 60], ..., (45, 60], (60, 100], (60, 100], (60, 100], (60, 100]]
Length: 14
Categories (4, interval[int64, right]): [(18, 29] < (29, 45] < (45, 60] < (60, 100]]
</pre>

```python
ge.categories
```

<pre>
IntervalIndex([(18, 29], (29, 45], (45, 60], (60, 100]], dtype='interval[int64, right]')
</pre>

```python
ge.codes
```

<pre>
array([0, 0, 1, 1, 2, 1, 1, 2, 1, 2, 3, 3, 3, 3], dtype=int8)
</pre>

```python
ge.value_counts()
```

<pre>
(18, 29]     2
(29, 45]     5
(45, 60]     3
(60, 100]    4
Name: count, dtype: int64
</pre>

```python
pd.cut(age,dis,right=False)
```

<pre>
[[18, 29), [18, 29), [29, 45), [29, 45), [45, 60), ..., [45, 60), [60, 100), [60, 100), [60, 100), [60, 100)]
Length: 14
Categories (4, interval[int64, left]): [[18, 29) < [29, 45) < [45, 60) < [60, 100)]
</pre>

```python
names = ['청년','중장년','중년','노년']
na= pd.cut(age,dis,labels=names)
```


```python
na.value_counts()
```

<pre>
청년     2
중장년    5
중년     3
노년     4
Name: count, dtype: int64
</pre>

```python
rng = np.random.RandomState(0)
data = rng.randn(20)
c= pd.cut(data, 4) #두 번째 인덱스 bins = 구간 (숫자를 주면 자동으로 구간을 나눠준다.값 기준으로 (최대, 최소))
c
```

<pre>
[(1.436, 2.241], (-0.173, 0.632], (0.632, 1.436], (1.436, 2.241], (1.436, 2.241], ..., (-0.173, 0.632], (1.436, 2.241], (-0.98, -0.173], (-0.173, 0.632], (-0.98, -0.173]]
Length: 20
Categories (4, interval[float64, right]): [(-0.98, -0.173] < (-0.173, 0.632] < (0.632, 1.436] < (1.436, 2.241]]
</pre>

```python
c.value_counts()
```

<pre>
(-0.98, -0.173]    3
(-0.173, 0.632]    9
(0.632, 1.436]     3
(1.436, 2.241]     5
Name: count, dtype: int64
</pre>

```python
data = rng.randn(1000)  

qc = pd.qcut(data, 4)  #1000개를 4개 구간으로 나누기 
# 전체 개수를 기준으로 구간을 나누어 구간별 데이터의 수가 동일
qc.value_counts()
```

<pre>
(-3.0469999999999997, -0.708]    250
(-0.708, -0.0601]                250
(-0.0601, 0.582]                 250
(0.582, 2.759]                   250
Name: count, dtype: int64
</pre>

```python
qc =  pd.qcut(data, [0,0.1,0.3,0.5,0.7,1])  #각 구간별 비중을 지정할수 있다./ 어디부분은 데이터 많고 어디는 적고
qc.value_counts()
```

<pre>
(-3.0469999999999997, -1.307]    100
(-1.307, -0.559]                 200
(-0.559, -0.0601]                200
(-0.0601, 0.416]                 200
(0.416, 2.759]                   300
Name: count, dtype: int64
</pre>
# 이상치(outlier) 걸러내기



```python
data = pd.DataFrame(rng.randn(1000,4))
data.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.015665</td>
      <td>0.701041</td>
      <td>-0.417477</td>
      <td>-1.097497</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.712305</td>
      <td>-0.792115</td>
      <td>-1.045525</td>
      <td>-1.084856</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.117305</td>
      <td>-0.518900</td>
      <td>-0.753704</td>
      <td>0.137690</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.206945</td>
      <td>-0.678095</td>
      <td>0.753991</td>
      <td>1.065315</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.985318</td>
      <td>0.766920</td>
      <td>0.402626</td>
      <td>-1.775888</td>
    </tr>
  </tbody>
</table>
</div>



```python
data.describe()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-0.036400</td>
      <td>0.011587</td>
      <td>-0.003675</td>
      <td>-0.002479</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.992339</td>
      <td>0.968516</td>
      <td>0.994501</td>
      <td>0.988656</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-3.740101</td>
      <td>-3.007437</td>
      <td>-3.116857</td>
      <td>-3.392300</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.760730</td>
      <td>-0.656073</td>
      <td>-0.671151</td>
      <td>-0.646979</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.015750</td>
      <td>-0.012295</td>
      <td>0.003705</td>
      <td>-0.063378</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.643699</td>
      <td>0.656041</td>
      <td>0.684573</td>
      <td>0.646954</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.929096</td>
      <td>2.979976</td>
      <td>3.801660</td>
      <td>3.427539</td>
    </tr>
  </tbody>
</table>
</div>



```python
data[(np.abs(data) > 3).any(axis=1)] #-3,3 범위 밖에 있는 행 들을 출력
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>-0.156024</td>
      <td>1.049093</td>
      <td>3.170975</td>
      <td>0.189500</td>
    </tr>
    <tr>
      <th>249</th>
      <td>0.708860</td>
      <td>0.422819</td>
      <td>-3.116857</td>
      <td>0.644452</td>
    </tr>
    <tr>
      <th>515</th>
      <td>-0.387313</td>
      <td>-0.347585</td>
      <td>3.306574</td>
      <td>-1.510200</td>
    </tr>
    <tr>
      <th>524</th>
      <td>-1.091033</td>
      <td>-0.126856</td>
      <td>3.801660</td>
      <td>2.315171</td>
    </tr>
    <tr>
      <th>606</th>
      <td>0.236225</td>
      <td>-0.752582</td>
      <td>0.045113</td>
      <td>3.427539</td>
    </tr>
    <tr>
      <th>610</th>
      <td>-0.087328</td>
      <td>-0.553965</td>
      <td>-3.006499</td>
      <td>-0.047166</td>
    </tr>
    <tr>
      <th>664</th>
      <td>-0.953179</td>
      <td>-0.479297</td>
      <td>-1.345508</td>
      <td>-3.392300</td>
    </tr>
    <tr>
      <th>683</th>
      <td>-3.740101</td>
      <td>0.973577</td>
      <td>1.175155</td>
      <td>-1.124703</td>
    </tr>
    <tr>
      <th>862</th>
      <td>0.903088</td>
      <td>-3.007437</td>
      <td>-2.330467</td>
      <td>-0.567803</td>
    </tr>
  </tbody>
</table>
</div>



```python
data[np.abs(data)> 3 ]= np.sign(data)*3
#sign 함수 -양수 :1,0:0, 음수: -1
data.describe()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-0.035660</td>
      <td>0.011594</td>
      <td>-0.004831</td>
      <td>-0.002515</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.989846</td>
      <td>0.968493</td>
      <td>0.989858</td>
      <td>0.985992</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-3.000000</td>
      <td>-3.000000</td>
      <td>-3.000000</td>
      <td>-3.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.760730</td>
      <td>-0.656073</td>
      <td>-0.671151</td>
      <td>-0.646979</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.015750</td>
      <td>-0.012295</td>
      <td>0.003705</td>
      <td>-0.063378</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.643699</td>
      <td>0.656041</td>
      <td>0.684573</td>
      <td>0.646954</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.929096</td>
      <td>2.979976</td>
      <td>3.000000</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div>



```python
df = pd.DataFrame(np.arange(5*4).reshape(5,4))
df
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>



```python
sample = rng.permutation(5)
sample
```

<pre>
array([1, 0, 3, 2, 4])
</pre>

```python
df.iloc[sample]
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>



```python
df.take(sample)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>



```python
df.sample(3)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>17</td>
      <td>18</td>
      <td>19</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>



```python
s1=pd.Series([7,3,-2,1,4])
s1.sample(n=10 , replace=True) #replace =False 가 기본값
#데이터가 더 커지는 경우 replace = False를 사용할 수 없다.
#replace = False -> 중복 허용 X
```

<pre>
4    4
1    3
3    1
4    4
3    1
2   -2
1    3
1    3
0    7
1    3
dtype: int64
</pre>
# 범주형(카테고리형) 변수 

- 지표, 더미 형태로 나타낼 필요가있다. (One-Hot Encoding)



```python
df = pd.DataFrame({'keys':list('bbacab'),
                  'data1': range(6)})
df
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>keys</th>
      <th>data1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>c</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>b</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>



```python
pd.get_dummies(df['keys'])
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>


movies.dat -> :: 기준으로 분류, 헤더 포함되어 있지않아서  헤더에 id,title,genre 를 추가하고싶음




```python
movies = pd.read_table('movies.dat',encoding = 'utf-8',sep = '::', header=None, names=['id','title','genre'],engine = 'python')#warning메세지떠서 engine pyhon으로 지정
movies.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>title</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy Story (1995)</td>
      <td>Animation|Children's|Comedy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji (1995)</td>
      <td>Adventure|Children's|Fantasy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpier Old Men (1995)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale (1995)</td>
      <td>Comedy|Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II (1995)</td>
      <td>Comedy</td>
    </tr>
  </tbody>
</table>
</div>



```python
all_genres = set()
for genre in movies.genre:
    all_genres.update(genre.split('|'))
    
print(all_genres)
```

<pre>
{'Film-Noir', 'Fantasy', 'War', 'Romance', 'Mystery', "Children's", 'Comedy', 'Thriller', 'Action', 'Documentary', 'Adventure', 'Animation', 'Drama', 'Sci-Fi', 'Horror', 'Crime', 'Western', 'Musical'}
</pre>

```python
all_genres =[]
for genre in movies.genre:
    all_genres.extend(genre.split('|'))
    
all_genres = pd.unique(all_genres)
all_genres
```

<pre>
/var/folders/2v/xs6232zx39d2lk8wg9_m8w1m0000gn/T/ipykernel_72854/2525905197.py:5: FutureWarning: unique with argument that is not not a Series, Index, ExtensionArray, or np.ndarray is deprecated and will raise in a future version.
  all_genres = pd.unique(all_genres)
</pre>
<pre>
array(['Animation', "Children's", 'Comedy', 'Adventure', 'Fantasy',
       'Romance', 'Drama', 'Action', 'Crime', 'Thriller', 'Horror',
       'Sci-Fi', 'Documentary', 'War', 'Musical', 'Mystery', 'Film-Noir',
       'Western'], dtype=object)
</pre>

```python
dummies = pd.DataFrame(np.zeros((len(movies), len(all_genres))), columns=all_genres)
dummies.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Animation</th>
      <th>Children's</th>
      <th>Comedy</th>
      <th>Adventure</th>
      <th>Fantasy</th>
      <th>Romance</th>
      <th>Drama</th>
      <th>Action</th>
      <th>Crime</th>
      <th>Thriller</th>
      <th>Horror</th>
      <th>Sci-Fi</th>
      <th>Documentary</th>
      <th>War</th>
      <th>Musical</th>
      <th>Mystery</th>
      <th>Film-Noir</th>
      <th>Western</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



```python
for i, gen in enumerate(movies.genre): # enumerate를 통해 각 행 i와 장르 gen 를 가져온다.
    ind = dummies.columns.get_indexer(gen.split('|')) # (columns) 어느 열에 있는지 (get_indexer) 인덱스 목록을 가져온다.
    dummies.iloc[i, ind] = 1
```


```python
dummies.iloc[0]
```

<pre>
Animation      1.0
Children's     1.0
Comedy         1.0
Adventure      0.0
Fantasy        0.0
Romance        0.0
Drama          0.0
Action         0.0
Crime          0.0
Thriller       0.0
Horror         0.0
Sci-Fi         0.0
Documentary    0.0
War            0.0
Musical        0.0
Mystery        0.0
Film-Noir      0.0
Western        0.0
Name: 0, dtype: float64
</pre>

```python
dummies.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Animation</th>
      <th>Children's</th>
      <th>Comedy</th>
      <th>Adventure</th>
      <th>Fantasy</th>
      <th>Romance</th>
      <th>Drama</th>
      <th>Action</th>
      <th>Crime</th>
      <th>Thriller</th>
      <th>Horror</th>
      <th>Sci-Fi</th>
      <th>Documentary</th>
      <th>War</th>
      <th>Musical</th>
      <th>Mystery</th>
      <th>Film-Noir</th>
      <th>Western</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



```python
val = 'a,b,       hello'
val.split(',')
```

<pre>
['a', 'b', '       hello']
</pre>

```python
val2 = val.split(',')
val2[2] = val2[2].strip()
val2
```

<pre>
['a', 'b', 'hello']
</pre>

```python
val2 = [x.strip() for x in val.split(',')]   #더 간단하게
val2
```

<pre>
['a', 'b', 'hello']
</pre>

```python
"::".join(val2)
```

<pre>
'a::b::hello'
</pre>

```python
import re # 정규 표현식 : 복잡한 문자열을 처리할 때 사용하는 기법(특정한 규칙을 가진 문자열 집합을 표현)

text = "hello     world\t  bye   \tworld"
```


```python
text
```

<pre>
'hello     world\t  bye   \tworld'
</pre>

```python
re.split("\s+",text) #공백 정규처리
```

<pre>
['hello', 'world', 'bye', 'world']
</pre>

```python
regex = re.compile('\s+')
regex.split(text)
```

<pre>
['hello', 'world', 'bye', 'world']
</pre>

```python
regex.findall(text)
```

<pre>
['     ', '\t  ', '   \t']
</pre>

```python
regex.match(text) #문자열의 시작 부분에서 정규 표현식과 일치하는지 확인
```


```python
text
```

<pre>
'hello     world\t  bye   \tworld'
</pre>

```python
re.search('\s+',text) # 정규표현식과 일치하는 첫번째 부분
```

<pre>
<re.Match object; span=(5, 10), match='     '>
</pre>
정규표현식 패턴



. : 임의의 한 문자 'a.c' -> abc, adc



^ : 문자열의 시작 ^abc' -> abcd, abc



$(달러) : 문자열의 끝 :'abc$ -> 항상 abc로끝나야됨 abc,abcabc



\d : 숫자(0-9) '\d'



\w : 알파벳, 숫자, 언더바(_) '\w'



\s : 공백 :'s'



\D : 숫자가 아닌 문자



\S : 공백이 아닌 문자



[] : 문자집합 하나의 문자와 매칭



[^] : 리스트 안에 문자를 제외한 문자 ->[^0-9] -> a,b


#반복패턴



*: 0회 이상 반복 : "ab*" -> a,ab,abab

+ : 1회 이상 반복반복 패턴  "\s+" -> ' ','  ','     '



? : 1이하로 존재 'a?' -> a, b





{n} : 정확히 n번 반복 

    

        {2222222222n,} : n번 이상 

    

{n,m} : n번 이상 m번 이하




```python
text = "Hello World, hellO python"
regex = re.compile("hello",flags=re.I) #IGNORECASE
regex.findall(text)
```

<pre>
['Hello', 'hellO']
</pre>
컴파일 옵션



DOTALL(S) - .(dot)이 줄바꿈 문자를 포함한 모든 문자



IGNORECASE(I) - 대소문자 구별하지 않는다.



MULTILINE(M) - 여러줄에서 매칭하는 경우



VERBOSE(X) - 정규식을 보기 편하게 만들어준다.



```python
p= re.compile('a,b',re.S)
m = p.match('a\nb')
m
```


```python
data = """Hello World
Hello
Python"""
```


```python
p= re.compile("^Hello\s+\w+")
p.findall(data)
```

<pre>
['Hello World']
</pre>

```python
text = """Dave dave@google.com
Steve steve@gmail.com
Rob rob@gmail.com
Ryan ryan@yahoo.com
"""

text
```

<pre>
'Dave dave@google.com\nSteve steve@gmail.com\nRob rob@gmail.com\nRyan ryan@yahoo.com\n'
</pre>

```python
#email 만 뽑아오기
pattern = r'[A-Z0-9._]+@[A-Z0-9._]+\.[A-Z]{2,4}'
```


```python
regex = re.compile(pattern, re.I)
regex.findall(text)
```

<pre>
['dave@google.com', 'steve@gmail.com', 'rob@gmail.com', 'ryan@yahoo.com']
</pre>

```python
#sub 문자열 교체
regex.sub('이메일을 입력하세요.',text)
```

<pre>
'Dave 이메일을 입력하세요.\nSteve 이메일을 입력하세요.\nRob 이메일을 입력하세요.\nRyan 이메일을 입력하세요.\n'
</pre>

```python
data = pd.Series({"Dave" : "dave@google.com", "Steve" : "steve@gmail.com", "Rob" : "rob@gmail.com", "Ryan" : "ryan@yahoo.com", "Eric" : np.nan})
data
```

<pre>
Dave     dave@google.com
Steve    steve@gmail.com
Rob        rob@gmail.com
Ryan      ryan@yahoo.com
Eric                 NaN
dtype: object
</pre>

```python
data.str.count('g')
```

<pre>
Dave     2.0
Steve    1.0
Rob      1.0
Ryan     0.0
Eric     NaN
dtype: float64
</pre>

```python
data[:-1].map(lambda x :x.count('g'))  # nan  이 존재해서 error 발생!
```

<pre>
Dave     2
Steve    1
Rob      1
Ryan     0
dtype: int64
</pre>

```python
data[:-1].map(lambda x :x.count('g'))
```

<pre>
Dave     2
Steve    1
Rob      1
Ryan     0
dtype: int64
</pre>

```python
data.str.contains('gmail')
```

<pre>
Dave     False
Steve     True
Rob       True
Ryan     False
Eric       NaN
dtype: object
</pre>

```python
data.str.findall(pattern,re.I)
```

<pre>
Dave     [dave@google.com]
Steve    [steve@gmail.com]
Rob        [rob@gmail.com]
Ryan      [ryan@yahoo.com]
Eric                   NaN
dtype: object
</pre>

```python
pattern_g = '([A-Za-z0-9._]+)@([A-Za-z0-9._]+)\\.([A-Za-z]{2,4})'
regex_g = re.compile(pattern_g, re.I)
```


```python
m_g = regex_g.search(text)
m_g.groups()
```

<pre>
('dave', 'google', 'com')
</pre>

```python
m_g.group()
```

<pre>
'dave@google.com'
</pre>

```python
m_g.group(3)
```

<pre>
'com'
</pre>

```python
regex_g.findall(text)
```

<pre>
[('dave', 'google', 'com'),
 ('steve', 'gmail', 'com'),
 ('rob', 'gmail', 'com'),
 ('ryan', 'yahoo', 'com')]
</pre>

```python
data.str.findall(pattern_g, re.I)
```

<pre>
Dave     [(dave, google, com)]
Steve    [(steve, gmail, com)]
Rob        [(rob, gmail, com)]
Ryan      [(ryan, yahoo, com)]
Eric                       NaN
dtype: object
</pre>

```python
ser = data.copy()
ser.iloc[0] = ser.iloc[0] + ', dave@naver.com'
ser
```

<pre>
Dave     dave@google.com, dave@naver.com
Steve                    steve@gmail.com
Rob                        rob@gmail.com
Ryan                      ryan@yahoo.com
Eric                                 NaN
dtype: object
</pre>

```python
data.str.extractall(pattern_g, re.I)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
    <tr>
      <th></th>
      <th>match</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Dave</th>
      <th>0</th>
      <td>dave</td>
      <td>google</td>
      <td>com</td>
    </tr>
    <tr>
      <th>Steve</th>
      <th>0</th>
      <td>steve</td>
      <td>gmail</td>
      <td>com</td>
    </tr>
    <tr>
      <th>Rob</th>
      <th>0</th>
      <td>rob</td>
      <td>gmail</td>
      <td>com</td>
    </tr>
    <tr>
      <th>Ryan</th>
      <th>0</th>
      <td>ryan</td>
      <td>yahoo</td>
      <td>com</td>
    </tr>
  </tbody>
</table>
</div>



```python
ser.str.extractall(pattern_g, re.I)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
    <tr>
      <th></th>
      <th>match</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Dave</th>
      <th>0</th>
      <td>dave</td>
      <td>google</td>
      <td>com</td>
    </tr>
    <tr>
      <th>1</th>
      <td>dave</td>
      <td>naver</td>
      <td>com</td>
    </tr>
    <tr>
      <th>Steve</th>
      <th>0</th>
      <td>steve</td>
      <td>gmail</td>
      <td>com</td>
    </tr>
    <tr>
      <th>Rob</th>
      <th>0</th>
      <td>rob</td>
      <td>gmail</td>
      <td>com</td>
    </tr>
    <tr>
      <th>Ryan</th>
      <th>0</th>
      <td>ryan</td>
      <td>yahoo</td>
      <td>com</td>
    </tr>
  </tbody>
</table>
</div>



```python
ser.str.get(0)
```

<pre>
Dave       d
Steve      s
Rob        r
Ryan       r
Eric     NaN
dtype: object
</pre>

```python
ser.str[:-1]
```

<pre>
Dave     dave@google.com, dave@naver.co
Steve                    steve@gmail.co
Rob                        rob@gmail.co
Ryan                      ryan@yahoo.co
Eric                                NaN
dtype: object
</pre>

```python
data = {'age': [25, 22, np.nan, 35, 45, np.nan, 24, 60],
        'gender': ['M', 'F', 'F', 'M', 'F', 'M', 'M', 'F']}
df = pd.DataFrame(data)
```


```python
#연령 기반으로 구간 나누기  카테고리명 :20대 30대 40대 50대 이상
bins = [0,29,39,49,np.inf]
labels = ['20대', '30대', '40대', '50대 이상']
df['age_group'] = pd.cut(df['age'], bins=bins, labels=labels, right=False)
print(df)
```

<pre>
    age gender age_group
0  25.0      M       20대
1  22.0      F       20대
2   NaN      F       NaN
3  35.0      M       30대
4  45.0      F       40대
5   NaN      M       NaN
6  24.0      M       20대
7  60.0      F    50대 이상
</pre>

```python

df['age'].fillna(df['age'].mean(), inplace=True)
df['age'] = df['age'].round().astype(int)
print(df)
```

<pre>
   age gender age_group
0   25      M       20대
1   22      F       20대
2   35      F       NaN
3   35      M       30대
4   45      F       40대
5   35      M       NaN
6   24      M       20대
7   60      F    50대 이상
</pre>

```python
#gender 
dummies = pd.get_dummies(df,columns = ['gender'])
print(dummies)
```

<pre>
   age age_group  gender_F  gender_M
0   25       20대     False      True
1   22       20대      True     False
2   35       NaN      True     False
3   35       30대     False      True
4   45       40대      True     False
5   35       NaN     False      True
6   24       20대     False      True
7   60    50대 이상      True     False
</pre>

```python
ser = pd.Series(rng.random(9), index = [list('aaabbccdd'),[1,2,3,1,3,1,2,3,3]])
ser
```

<pre>
a  1    0.347326
   2    0.509638
   3    0.066632
b  1    0.090091
   3    0.185760
c  1    0.261868
   2    0.518593
d  3    0.535167
   3    0.763013
dtype: float64
</pre>

```python
ser.index
```

<pre>
MultiIndex([('a', 1),
            ('a', 2),
            ('a', 3),
            ('b', 1),
            ('b', 3),
            ('c', 1),
            ('c', 2),
            ('d', 3),
            ('d', 3)],
           )
</pre>

```python
ser['b':'c']
```

<pre>
b  1    0.090091
   3    0.185760
c  1    0.261868
   2    0.518593
dtype: float64
</pre>

```python
ser.loc[['a','d']]
```

<pre>
a  1    0.347326
   2    0.509638
   3    0.066632
d  3    0.535167
   3    0.763013
dtype: float64
</pre>

```python
ser.loc[:,2]
```

<pre>
a    0.509638
c    0.518593
dtype: float64
</pre>

```python
ser #Series 에서 멀티인덱스 구성된 데이터 ->2차원 (DataFrame)
```

<pre>
a  1    0.347326
   2    0.509638
   3    0.066632
b  1    0.090091
   3    0.185760
c  1    0.261868
   2    0.518593
d  3    0.535167
   3    0.763013
dtype: float64
</pre>

```python
# 데이터 프레임 병합 (merge.concat)
df1= pd.DataFrame({'A':['A'+str(i) for i in range(4)]})
df1
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
    </tr>
  </tbody>
</table>
</div>



```python
df2= pd.DataFrame({'B':['B'+str(i) for i in range(4)]})
df2
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>


pd.merge(df1,df2) # 데이터를 병합하려면 공통된 부분을 찾아서 해당 부분을 기준으로 병합을 할 수 있다.



```python
df3 = pd.DataFrame({'B':['B'+str(i) for i in range(4)], 'C':['C'+str(i) for i in range(4)]})
df3.loc[4] = ['B4', 'C4']
df3
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B0</td>
      <td>C0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B2</td>
      <td>C2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B3</td>
      <td>C3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B4</td>
      <td>C4</td>
    </tr>
  </tbody>
</table>
</div>



```python
pd.merge(df2, df3)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B0</td>
      <td>C0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B2</td>
      <td>C2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B3</td>
      <td>C3</td>
    </tr>
  </tbody>
</table>
</div>



```python
df4 = df2.copy()
df4.loc[3] = 'B0'
df4
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B0</td>
    </tr>
  </tbody>
</table>
</div>



```python
df5 = df3.copy()
df5.loc[4, 'B'] = 'B0'
df5
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B0</td>
      <td>C0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B2</td>
      <td>C2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B3</td>
      <td>C3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B0</td>
      <td>C4</td>
    </tr>
  </tbody>
</table>
</div>



```python
pd.merge(df4, df5)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B0</td>
      <td>C0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B0</td>
      <td>C4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B0</td>
      <td>C0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B0</td>
      <td>C4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B2</td>
      <td>C2</td>
    </tr>
  </tbody>
</table>
</div>



```python
pd.merge(df4, df5, how='outer') # default = inner (교집합) (outer: 합집합, left: 왼쪽 데이터, right: 오른쪽 데이터 기준)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B0</td>
      <td>C0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B0</td>
      <td>C4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B0</td>
      <td>C0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B0</td>
      <td>C4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B2</td>
      <td>C2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>B3</td>
      <td>C3</td>
    </tr>
  </tbody>
</table>
</div>



```python
left = pd.DataFrame({'key1':['foo', 'bar', 'bar'],
                     'key2':['one', 'two', 'one'],
                     'lval':[1,2,3]})
left
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>lval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bar</td>
      <td>two</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bar</td>
      <td>one</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>



```python
right = pd.DataFrame({'key1':['foo','foo','bar','bar'],
                      'key2':['one','one','one','two'],
                      'rval':[4,5,6,7]})
right
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>rval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>one</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bar</td>
      <td>one</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bar</td>
      <td>two</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>



```python
pd.merge(left, right, on=['key1', 'key2'], how='outer') # on = 병합키
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>lval</th>
      <th>rval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>one</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bar</td>
      <td>two</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bar</td>
      <td>one</td>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



```python
pd.merge(left, right, on='key1')
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key1</th>
      <th>key2_x</th>
      <th>lval</th>
      <th>key2_y</th>
      <th>rval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>1</td>
      <td>one</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>one</td>
      <td>1</td>
      <td>one</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bar</td>
      <td>two</td>
      <td>2</td>
      <td>one</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bar</td>
      <td>two</td>
      <td>2</td>
      <td>two</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>one</td>
      <td>3</td>
      <td>one</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bar</td>
      <td>one</td>
      <td>3</td>
      <td>two</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>

